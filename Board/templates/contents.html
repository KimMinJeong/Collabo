{% extends "board_top.html" %}
{% block body %}
{{ super() }}

<div class="container center-block">
    <div class="row-fluid ">
	    <div class="col-sm-5 col-md-5">
	        <h2 align="left">{{posts.subject}}</h2>
	    </div>
	    <div class="col-sm-2 col-md-2" >
	        <h4 class="text-muted page-bottom" align="center">
	        	{{posts.category}}
	        </h4>
	    </div>    	
	    <div class="col-sm-2 col-md-3 col-md-offset-2">
	    	 <img src={{session.get('gravatar')}} align="right">
	         <h4 name="email" align="right"> {{session['email']}}</h4>
	    </div>           
	   
	   <div class="col-md-12 col-sm-12 center-block">
	    	 {{ posts.contents }} 
	    </div>
	    
	   </div>    
		
	</div> 
<div class="container center-block">  	
	<form action="{{ url_for('admin', id=posts.id)}}" method="post">
    <div class="col-md-12">
        <table class="table table-striped" border="1">
        <thead>
			<p>현재 제안서는 상태입니다.
        	<button class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">
        	제안상태변경
			</button></p>
			<!-- Modal -->
			<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			  <div class="modal-dialog">
			    <div class="modal-content">
			      <div class="modal-header">
			        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			        <h2 class="modal-title" id="myModalLabel">제안상태변경하기</h2>
	 </div>
			      
		 <div class="modal-body">
		    	<div  class="btn-group">
			  		<div class="dropdown">
			  			<p>상태</p>
                  		<a href="#" data-toggle="dropdown" class="dropdown-toggle">제안상태<b class="caret"></b></a>
                   		<ul class="dropdown-menu" id="status" name="status">
                       		<li><a href="#" value="develope_wait">개발예정</a></li>
                       		<li><a href="#" value="developing">개발중</a></li>
                      		<li><a href="#" value="update">업데이트</a></li>
                       		<li><a href="#" value="reject">반려</a></li>
                   		</ul>
            		</div>
            		<div>
            		<p>의견</p>
            		<textarea rows="8" cols="50" value="comment" name="comment"> </textarea>
            		</div>
			   	</div>
			</div>
			 <div class="modal-footer">
			      <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			        <input type="submit" class="btn btn-primary" value="변경완료">
			      </div>
			    </div><!-- /.modal-content -->
			  </div><!-- /.modal-dialog -->
			</div><!-- /.modal -->
        </thead> 
        
        <tbody>
        	<tr><td> 이곳에 제안서에 대한 의견을 작성해주세요</td></tr>
        	<tr><td> 이곳에 제안서에 대한 의견을 작성해주세요</td></tr>
        	<tr><td> </td></tr>
        </tbody>
		</table>
	</div>
	</form>
    <br/>
    <br/>
    <br/>
    <br/>
    <hr>
	</div>
	
	
    <!-- 댓글 부분 -->
    <div class="container center-block">
    <div class="row-fluid">
        <div class="col-md-12" name="comm_list">
            <ul class="list-unstyled list-inline">
            	<hr>
               	{% for comm in comm_list %}
                <li > {{ comm.email }} </li>
                <li> {{ comm.created_at.date() }}</li><br>
                <li id={{comm.id}}> {{ comm.comment }}</li>
                <div class={{comm.id}}>
                	<form action="{{url_for('update_comm', id=comm.id)}}" method="post">
						
                	</form>
                </div>
                {%if comm.email==session.get('email') %}
                <a class="btn btn-default modify" data-id={{comm.id}} id={{comm.id}} role="button">수정</a>
                <a class="btn btn-default" href="{{ url_for('del_comm', id=comm.id ) }}" role="button">삭제</a>
                {% endif %}
                <hr>
            	{% endfor %}
            </ul>
        </div>
    </div>
	<div id="add_comm">
	    <form action="{{ url_for('add_comm', id=posts.id) }}" method="post" >
	    <ul class="list-inline">
	      <li><img src="{{session.get('gravatar')}}"></li>
	      <li><p class="form-control-static" name="email">{{session.get('email')}}</p></li>
	    </ul>                            
	       <textarea class="form-control" name="comment" rows="3" > </textarea>  
	      <input type="submit" class="pull-right" value="댓글 입력">    
	    </form>
	</div>
	<hr>
</div>
</div>



<script type="text/javascript">
	$('.dropdown-toggle').dropdown();
	$(".dropdown-menu li a").click(function(){
  var selText = $(this).text();
  $(this).parents('.btn-group').find('.dropdown-toggle').html(selText+'<span class="caret"></span>');
});
</script>

<script type="text/javascript">

	$('.modify').on('click', function(){
		var data=$(this).data('id');
		var str= $('#' + data).text();
		
		$('.'+data)
			.html(
				"<form method='post'>" +
				"<textarea name='comment_modify'>" + str + "</textarea>"
			+ "<input type='submit' value='수정'/>" + "</form>")	
			.find('form')
			.attr('action', {{ url_for('update_comm', id=-1 )|tojson }}.replace('-1', data));
					
	
		
		
	});

	
</script>
<script type="text/javascript">
	
</script>

{% endblock %}
